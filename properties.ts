import { Complex, type MultiSize, type Property } from './types'

const addDirections = (name: string, abbreviation: string, defaultValue: string | undefined = undefined) => ({
  [name]: [name, defaultValue],
  [abbreviation]: name,
  [`${name}Top`]: [`${name}Top`, defaultValue],
  [`${abbreviation}t`]: `${name}Top`,
  [`${name}Bottom`]: [`${name}Bottom`, defaultValue],
  [`${abbreviation}b`]: `${name}Bottom`,
  [`${name}Left`]: [`${name}Left`, defaultValue],
  [`${abbreviation}l`]: `${name}Left`,
  [`${name}Right`]: [`${name}Right`, defaultValue],
  [`${abbreviation}r`]: `${name}Right`,
})

const addAxes = (name: string, abbreviation: string, defaultValue: string | undefined = undefined) => ({
  [`${name}Vertical`]: [`${name}Vertical`, defaultValue],
  [`${abbreviation}v`]: `${name}Vertical`,
  [`${name}Horizontal`]: [`${name}Horizontal`, defaultValue],
  [`${abbreviation}h`]: `${name}Horizontal`,
})

const bigSize = (size?: MultiSize) => (Array.isArray(size) ? size[0] : size) ?? 10
const smallSize = (size?: MultiSize) => (Array.isArray(size) ? size[1] : size) ?? 2

export const getProperties: () => { [key: string]: Property } = () => ({
  justifyContent: ['justifyContent', 'center'],
  centerHorizontal: 'justifyContent-center',
  centerVertical: 'alignItems-center',
  jc: 'justifyContent-center',
  between: 'justifyContent-space-between',
  alignItems: ['alignItems', 'center'],
  items: 'alignItems',
  alignContent: ['alignContent', 'normal'],
  align: 'alignContent', // TODO ambiguous for alignItems or alignContent...
  display: ['display', 'flex'],
  flex: 'display',
  inlineFlex: 'display-inline-flex',
  inline: 'inlineFlex',
  df: 'display',
  flexDirection: ['flexDirection', 'row'],
  row: 'flexDirection-row',
  column: 'flexDirection-column',
  col: 'column',
  direction: 'flexDirection',
  flexWrap: ['flexWrap', 'wrap'], // nowrap is the default.
  wrap: 'flexWrap',
  whiteSpace: ['whiteSpace', 'nowrap'],
  nowrap: 'whiteSpace',
  gap: ['gap', 'medium'],
  space: 'gap',
  columnGap: ['columnGap'],
  rowGap: ['rowGap'],
  order: ['order'],
  flex1: ['flex', '[1]'],
  flex0: ['flex', '[0]'],
  flexAuto: ['flex', 'auto'],
  flexNone: ['flex', 'none'],
  flexGrow: ['flexGrow', '[0]'],
  grow: 'flexGrow',
  flexShrink: ['flexShrink', '[1]'],
  shrink: 'flexShrink',
  flexBasis: ['flexBasis', 'auto'],
  basis: 'flexBasis',
  alignSelf: ['alignSelf', 'auto'],
  self: 'alignSelf',
  borderRadius: ['borderRadius', 'medium'],
  overflow: ['overflow', 'auto'],
  scroll: 'overflow',
  textOverflow: ['textOverflow', 'ellipsis'],
  ellipsis: 'textOverflow',
  radius: 'borderRadius',
  borderTopLeftRadius: ['borderTopLeftRadius', 'medium'],
  borderTopRightRadius: ['borderTopRightRadius', 'medium'],
  borderBottomLeftRadius: ['borderBottomLeftRadius', 'medium'],
  borderBottomRightRadius: ['borderBottomRightRadius', 'medium'],
  rounded: 'borderRadius',
  background: ['background'],
  bg: 'background',
  backgroundColor: ['backgroundColor'],
  backgroundPosition: ['backgroundPosition', 'inherit'],
  backgroundRepeat: ['backgroundRepeat', 'no-repeat'],
  backgroundSize: ['backgroundSize', 'cover'],
  color: ['color'],
  width: ['width'],
  w: 'width',
  fullWidth: ['width', '100%'],
  maxWidth: ['maxWidth'],
  maxW: 'maxWidth',
  minWidth: ['minWidth'],
  minW: 'minWidth',
  fullHeight: ['height', '100%'],
  maxHeight: ['maxHeight'],
  maxH: 'maxHeight',
  minHeight: ['minHeight', '100vh'],
  minH: 'minHeight',
  height: ['height'],
  h: 'height',
  ...addDirections('padding', 'p', 'medium'),
  ...addAxes('padding', 'p', 'medium'),
  ...addDirections('margin', 'm', 'medium'),
  ...addAxes('margin', 'm', 'medium'),
  ...addDirections('border', 'b', 'none'),
  ...addAxes('border', 'b', 'none'),
  border: ['border', '[1px solid black]'],
  noBorder: 'border-none',
  borderColor: ['borderColor', 'black'],
  borderWidth: ['borderWidth', 1],
  borderStyle: ['borderStyle', 'solid'],
  textAlign: ['textAlign', 'center'],
  text: 'textAlign',
  fontFamily: ['fontFamily', '[sans-serif]'],
  font: 'fontFamily',
  mono: 'fontFamily-monospace',
  serif: 'fontFamily-serif',
  sansSerif: 'fontFamily',
  sans: 'fontFamily',
  fontWeight: ['fontWeight', 'normal'],
  fontSize: ['fontSize', 'medium'],
  fs: 'fontSize',
  fontStyle: ['fontStyle', 'normal'],
  italic: 'fontStyle-italic',
  bold: 'fontWeight-bold',
  weight: 'fontWeight',
  outline: ['outline', 'none'],
  textDecoration: ['textDecoration', 'none'],
  decoration: 'textDecoration',
  visibility: ['visibility', 'hidden'],
  hidden: 'visibility',
  visible: 'visibility-visible',
  aspectRatio: ['aspectRatio', 'auto'],
  ratio: 'aspectRatio',
  square: 'aspectRatio-[1]',
  aspect: 'aspectRatio',
  position: ['position', 'static'],
  relative: 'position-relative',
  absolute: 'position-absolute',
  fixed: 'position-fixed',
  sticky: 'position-sticky',
  boxSizing: ['boxSizing', 'border-box'],
  borderBox: 'boxSizing',
  box: 'boxSizing',
  top: ['top', 0],
  right: ['right', 0],
  bottom: ['bottom', 0],
  left: ['left', 0],
  inset: ['inset', 0],
  tp: 'top',
  ri: 'right',
  bt: 'bottom',
  lt: 'left',
  appearance: ['appearance', 'none'],
  flip: ['transform', '[scale(-1,-1)]'],
  flipHorizontal: ['transform', '[scale(-1,1)]'],
  flipVertical: ['transform', '[scale(1,-1)]'],
  cursor: ['cursor', 'pointer'],
  noCursor: ['cursor', 'auto'],
  // Deprecated, non-standard properties.
  lineClamp: ['WebkitLineClamp', '1'],
  boxOrient: ['WebkitBoxOrient', 'vertical'],
  webKitBox: ['display', 'webkit-box'],
  // CSS Grid
  grid: 'display-grid',
  gridTemplateRows: ['gridTemplateRows', 'none'],
  gridTemplateColumns: ['gridTemplateColumns', 'none'],
  gridRow: ['gridRow', 'auto'],
  gridColumn: ['gridColumn', 'auto'],
  boxShadow: ['boxShadow', 'none'],
  textShadow: ['textShadow', 'none'],
  // Complex properties (dynamically calculated).
  boxShadowX: [
    'boxShadow',
    ({ size, color = '#000000AA' }) =>
      `0 ${Math.round(bigSize(size) / 2)}px ${Math.round(bigSize(size) / 2)}px ${Math.round(bigSize(size) / 4)}px ${color}`,
  ],
  shadow: 'boxShadowX',
  textShadowX: ['textShadow', ({ size, color = 'black' }) => `${smallSize(size)}px ${smallSize(size)}px ${smallSize(size)}px ${color}`],
  scale: ['transform', ({ arbitrary = '0.5' }) => `scale(${arbitrary})`],
  scaleY: ['transform', ({ arbitrary = '0.5' }) => `scaleY(${arbitrary})`],
  innerRadius: [
    'WebkitMaskImage',
    ({ size }) =>
      `radial-gradient(circle ${bigSize(size)}px at 0 0, transparent 0, transparent ${bigSize(size) * 2}px, black ${bigSize(size) * 2 + 1}px)`,
  ],
  // TODO complex with Complex.multiple, was size[0][0], size[1][1]
  multiple: ['transform', ({ size }) => `${bigSize(size)}-${smallSize(size)}`, Complex.Multiple],
})

export const getShortcuts = () => ({
  button: 'outline noBorder cursor background-none',
  input: 'outline noBorder',
  link: 'decoration color-inherit',
  normal: 'margin-0', // Normalize headings and p.
  marginX: 'marginLeft marginRight', // Common old way to center items.
  mx: 'marginX',
  paddingX: 'paddingLeft paddingRight',
  px: 'paddingX',
  paddingY: 'paddingTop paddingBottom',
  py: 'paddingY',
  code: 'mono bg-lightgray p-3 radius-3',
  borderTopRadius: 'borderTopLeftRadius borderTopRightRadius',
  borderBottomRadius: 'borderBottomLeftRadius borderBottomRightRadius',
  center: 'centerHorizontal centerVertical',
  singleLineText: 'overflow-hidden nowrap ellipsis display-initial',
  // Deprecated, non-standard properties.
  webKitEllipsis: 'overflow-hidden lineClamp boxOrient webKitBox',
})
