import { Complex, type MultiSize, type Property } from './types'

const addDirections = (name: string, abbreviation: string, defaultValue: string | undefined = undefined) => ({
  [name]: [name, defaultValue],
  [abbreviation]: name,
  [`${name}Top`]: [`${name}Top`, defaultValue],
  [`${abbreviation}t`]: `${name}Top`,
  [`${name}Bottom`]: [`${name}Bottom`, defaultValue],
  [`${abbreviation}b`]: `${name}Bottom`,
  [`${name}Left`]: [`${name}Left`, defaultValue],
  [`${abbreviation}l`]: `${name}Left`,
  [`${name}Right`]: [`${name}Right`, defaultValue],
  [`${abbreviation}r`]: `${name}Right`,
})

const addAxes = (name: string, abbreviation: string, defaultValue: string | undefined = undefined) => ({
  [`${name}Vertical`]: ['paddingVertical', defaultValue],
  [`${abbreviation}v`]: `${name}Vertical`,
  [`${name}Horizontal`]: ['paddingHorizontal', defaultValue],
  [`${abbreviation}h`]: `${name}Horizontal`,
})

const bigSize = (size?: MultiSize) => (Array.isArray(size) ? size[0] : size) ?? 10
const smallSize = (size?: MultiSize) => (Array.isArray(size) ? size[1] : size) ?? 2

export const getProperties: () => { [key: string]: Property } = () => ({
  justifyContent: ['justifyContent', 'center'],
  centerHorizontal: 'justifyContent-center',
  centerVertical: 'alignItems-center',
  jc: 'justifyContent-center',
  between: 'justifyContent-space-between',
  alignItems: ['alignItems', 'center'],
  items: 'alignItems',
  alignContent: ['alignContent', 'normal'],
  align: 'alignContent', // TODO ambiguous for alignItems or alignContent...
  display: ['display', 'flex'],
  flex: 'display',
  df: 'display',
  flexDirection: ['flexDirection', 'row'],
  row: 'flexDirection-row',
  column: 'flexDirection-column',
  direction: 'flexDirection',
  flexWrap: ['flexWrap', 'wrap'], // nowrap is the default.
  wrap: 'flexWrap',
  gap: ['gap', 'medium'],
  space: 'gap',
  columnGap: ['columnGap'],
  rowGap: ['rowGap'],
  order: ['order'],
  flexGrow: ['flexGrow', '[0]'],
  grow: 'flexGrow',
  flexShrink: ['flexShrink', '[1]'],
  shrink: 'flexShrink',
  flexBasis: ['flexBasis', 'auto'],
  basis: 'flexBasis',
  alignSelf: ['alignSelf', 'auto'],
  self: 'alignSelf',
  borderRadius: ['borderRadius', 'medium'],
  radius: 'borderRadius',
  borderTopLeftRadius: ['borderTopLeftRadius', 'medium'],
  borderTopRightRadius: ['borderTopRightRadius', 'medium'],
  borderBottomLeftRadius: ['borderBottomLeftRadius', 'medium'],
  borderBottomRightRadius: ['borderBottomRightRadius', 'medium'],
  rounded: 'borderRadius',
  background: ['background'],
  bg: 'background',
  backgroundColor: ['backgroundColor'],
  color: ['color'],
  width: ['width'],
  w: 'width',
  fullWidth: ['width', '100%'],
  maxWidth: ['maxWidth'],
  maxW: 'maxWidth',
  height: ['height'],
  h: 'height',
  fullHeight: ['height', '100%'],
  maxHeight: ['maxHeight'],
  maxH: 'maxHeight',
  ...addDirections('padding', 'p', 'medium'),
  ...addAxes('padding', 'p', 'medium'),
  ...addDirections('margin', 'm', 'medium'),
  ...addAxes('margin', 'm', 'medium'),
  ...addDirections('border', 'b', 'none'),
  ...addAxes('border', 'b', 'none'),
  textAlign: ['textAlign', 'center'],
  text: 'textAlign',
  fontFamily: ['fontFamily', '[sans-serif]'],
  font: 'fontFamily',
  mono: 'fontFamily-monospace',
  serif: 'fontFamily-serif',
  sansSerif: 'fontFamily',
  sans: 'fontFamily',
  fontWeight: ['fontWeight', 'normal'],
  fontSize: ['fontSize', 'medium'],
  bold: 'fontWeight-bold',
  weight: 'fontWeight',
  outline: ['outline', 'none'],
  textDecoration: ['textDecoration', 'none'],
  decoration: 'textDecoration',
  shadow: 'boxShadow',
  visibility: ['visibility', 'hidden'],
  hidden: 'visibility',
  visible: 'visibility-visible',
  aspectRatio: ['aspectRatio', 'auto'],
  ratio: 'aspectRatio',
  square: 'aspectRatio-[1]',
  aspect: 'aspectRatio',
  position: ['position', 'static'],
  relative: 'position-relative',
  absolute: 'position-absolute',
  fixed: 'position-fixed',
  sticky: 'position-sticky',
  top: ['top', 0],
  right: ['right', 0],
  bottom: ['bottom', 0],
  left: ['left', 0],
  tp: 'top',
  ri: 'right',
  bt: 'bottom',
  lt: 'left',
  flip: ['transform', '[scale(-1,-1)]'],
  flipHorizontal: ['transform', '[scale(-1,1)]'],
  flipVertical: ['transform', '[scale(1,-1)]'],
  cursor: ['cursor', 'pointer'],
  // CSS Grid
  grid: 'display-grid',
  gridTemplateRows: ['gridTemplateRows', 'none'],
  gridTemplateColumns: ['gridTemplateColumns', 'none'],
  gridRow: ['gridRow', 'auto'],
  gridColumn: ['gridColumn', 'auto'],
  // Complex properties (dynamically calculated).
  boxShadow: [
    'boxShadow',
    ({ size, color = '#000000AA' }) =>
      `0 ${Math.round(bigSize(size) / 2)}px ${Math.round(bigSize(size) / 2)}px ${Math.round(bigSize(size) / 4)}px ${color}`,
  ],
  textShadow: ['textShadow', ({ size, color = 'black' }) => `${smallSize(size)}px ${smallSize(size)}px ${smallSize(size)}px ${color}`],
  scale: ['transform', ({ arbitrary = '0.5' }) => `scale(${arbitrary})`],
  scaleY: ['transform', ({ arbitrary = '0.5' }) => `scaleY(${arbitrary})`],
  innerRadius: [
    'WebkitMaskImage',
    ({ size }) =>
      `radial-gradient(circle ${bigSize(size)}px at 0 0, transparent 0, transparent ${bigSize(size) * 2}px, black ${bigSize(size) * 2 + 1}px)`,
  ],
  // TODO complex with Complex.multiple, was size[0][0], size[1][1]
  multiple: ['transform', ({ size }) => `${bigSize(size)}-${smallSize(size)}`, Complex.Multiple],
})

export const getShortcuts = () => ({
  button: 'outline border cursor',
  input: 'outline border',
  link: 'decoration',
  marginX: 'marginLeft marginRight', // Common old way to center items.
  mx: 'marginX',
  paddingX: 'paddingLeft paddingRight',
  px: 'paddingX',
  paddingY: 'paddingTop paddingBottom',
  py: 'paddingY',
  code: 'mono bg-lightgray p-3 radius-3',
  borderTopRadius: 'borderTopLeftRadius borderTopRightRadius',
  center: 'centerHorizontal centerVertical',
})
